<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Upload Debug</title>
</head>
<body>
    <h1>Test Upload Debug</h1>
    
    <div>
        <h2>Upload Test</h2>
        <input type="file" id="uploadInput" accept="image/*">
        <button onclick="testUpload()">Test Upload</button>
        <div id="uploadResult"></div>
    </div>
    
    <div>
        <h2>Check File System</h2>
        <button onclick="checkFileSystem()">Check File System</button>
        <div id="fileSystemResult"></div>
    </div>
    
    <script>
        function log(message, elementId) {
            console.log(message);
            document.getElementById(elementId).innerHTML += '<div>' + message + '</div>';
        }
        
        async function testUpload() {
            const fileInput = document.getElementById('uploadInput');
            const file = fileInput.files[0];
            
            if (!file) {
                log('âŒ Please select a file', 'uploadResult');
                return;
            }
            
            log('ğŸ§ª Testing upload...', 'uploadResult');
            log('ğŸ“Š File name: ' + file.name, 'uploadResult');
            log('ğŸ“Š File size: ' + file.size + ' bytes', 'uploadResult');
            log('ğŸ“Š File type: ' + file.type, 'uploadResult');
            
            const formData = new FormData();
            formData.append('images', file);
            
            try {
                const response = await fetch('https://skinvox-backend.onrender.com/api/admin/upload', {
                    method: 'POST',
                    body: formData,
                });
                
                log('ğŸ“Š Response status: ' + response.status, 'uploadResult');
                
                if (!response.ok) {
                    const errorText = await response.text();
                    log('âŒ Upload failed: ' + errorText, 'uploadResult');
                    return;
                }
                
                const result = await response.json();
                log('âœ… Upload successful!', 'uploadResult');
                log('ğŸ“Š Result: ' + JSON.stringify(result, null, 2), 'uploadResult');
                
                // Test if the uploaded file is accessible
                if (result.files && result.files[0]) {
                    const fileUrl = 'https://skinvox-backend.onrender.com' + result.files[0].url;
                    log('ğŸ”— Testing file URL: ' + fileUrl, 'uploadResult');
                    
                    try {
                        const imageResponse = await fetch(fileUrl);
                        if (imageResponse.ok) {
                            log('âœ… File is accessible via URL', 'uploadResult');
                        } else {
                            log('âŒ File is not accessible via URL: ' + imageResponse.status, 'uploadResult');
                        }
                    } catch (error) {
                        log('âŒ Error testing file URL: ' + error.message, 'uploadResult');
                    }
                }
            } catch (error) {
                log('âŒ Upload error: ' + error.message, 'uploadResult');
            }
        }
        
        async function checkFileSystem() {
            log('ğŸ§ª Checking file system...', 'fileSystemResult');
            
            try {
                // Test if the uploads directory is accessible
                const testUrl = 'https://skinvox-backend.onrender.com/uploads/admins/admin/blogs/';
                log('ğŸ”— Testing uploads directory: ' + testUrl, 'fileSystemResult');
                
                const response = await fetch(testUrl);
                log('ğŸ“Š Directory response status: ' + response.status, 'fileSystemResult');
                
                if (response.ok) {
                    log('âœ… Uploads directory is accessible', 'fileSystemResult');
                } else {
                    log('âŒ Uploads directory is not accessible', 'fileSystemResult');
                }
                
                // Test specific file
                const testFileUrl = 'https://skinvox-backend.onrender.com/uploads/admins/admin/blogs/da1.jpg';
                log('ğŸ”— Testing specific file: ' + testFileUrl, 'fileSystemResult');
                
                const fileResponse = await fetch(testFileUrl);
                log('ğŸ“Š File response status: ' + fileResponse.status, 'fileSystemResult');
                
                if (fileResponse.ok) {
                    log('âœ… File da1.jpg is accessible', 'fileSystemResult');
                } else {
                    log('âŒ File da1.jpg is not accessible', 'fileSystemResult');
                }
                
            } catch (error) {
                log('âŒ Error checking file system: ' + error.message, 'fileSystemResult');
            }
        }
    </script>
</body>
</html>
