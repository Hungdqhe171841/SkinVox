<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Simple Upload</title>
</head>
<body>
    <h1>Test Simple Upload</h1>
    
    <div>
        <h2>Single Image Upload Test</h2>
        <input type="file" id="singleUpload" accept="image/*">
        <button onclick="testSingleUpload()">Upload Single Image</button>
        <div id="singleResult"></div>
    </div>
    
    <div>
        <h2>Multiple Images Upload Test</h2>
        <input type="file" id="multipleUpload" accept="image/*" multiple>
        <button onclick="testMultipleUpload()">Upload Multiple Images</button>
        <div id="multipleResult"></div>
    </div>
    
    <script>
        function log(message, elementId) {
            console.log(message);
            document.getElementById(elementId).innerHTML += '<div>' + message + '</div>';
        }
        
        async function testSingleUpload() {
            const fileInput = document.getElementById('singleUpload');
            const file = fileInput.files[0];
            
            if (!file) {
                log('‚ùå Please select a file', 'singleResult');
                return;
            }
            
            log('üß™ Testing single image upload...', 'singleResult');
            log('üìä File name: ' + file.name, 'singleResult');
            log('üìä File size: ' + file.size + ' bytes', 'singleResult');
            log('üìä File type: ' + file.type, 'singleResult');
            
            const formData = new FormData();
            formData.append('images', file);
            
            try {
                log('üì§ Sending request to: https://skinvox-backend.onrender.com/api/admin/upload', 'singleResult');
                
                const response = await fetch('https://skinvox-backend.onrender.com/api/admin/upload', {
                    method: 'POST',
                    body: formData,
                });
                
                log('üìä Response status: ' + response.status, 'singleResult');
                log('üìä Response status text: ' + response.statusText, 'singleResult');
                
                if (!response.ok) {
                    const errorText = await response.text();
                    log('‚ùå Upload failed: ' + errorText, 'singleResult');
                    return;
                }
                
                const result = await response.json();
                log('‚úÖ Upload successful!', 'singleResult');
                log('üìä Result: ' + JSON.stringify(result, null, 2), 'singleResult');
            } catch (error) {
                log('‚ùå Upload error: ' + error.message, 'singleResult');
            }
        }
        
        async function testMultipleUpload() {
            const fileInput = document.getElementById('multipleUpload');
            const files = Array.from(fileInput.files);
            
            if (files.length === 0) {
                log('‚ùå Please select files', 'multipleResult');
                return;
            }
            
            log('üß™ Testing multiple images upload...', 'multipleResult');
            log('üìä Number of files: ' + files.length, 'multipleResult');
            
            try {
                const uploadPromises = files.map(async (file, index) => {
                    log('üì§ Uploading file ' + (index + 1) + ': ' + file.name, 'multipleResult');
                    
                    const formData = new FormData();
                    formData.append('images', file);
                    
                    const response = await fetch('https://skinvox-backend.onrender.com/api/admin/upload', {
                        method: 'POST',
                        body: formData,
                    });
                    
                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`Upload ${file.name} failed: ${response.status} ${response.statusText} - ${errorText}`);
                    }
                    
                    const result = await response.json();
                    return result;
                });
                
                const results = await Promise.all(uploadPromises);
                log('‚úÖ All uploads successful!', 'multipleResult');
                log('üìä Results: ' + JSON.stringify(results, null, 2), 'multipleResult');
            } catch (error) {
                log('‚ùå Upload error: ' + error.message, 'multipleResult');
            }
        }
    </script>
</body>
</html>
